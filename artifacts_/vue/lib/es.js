const e=require("vue"),{ref:t,reactive:s,watch:n}=e,a="vueKey";function r(e){if(e.hasMeta(a))return e.getMeta(a);{const s=t();return e.value&&(s.value=e.value),e.up(e=>s.value=e),s}}function o(e){const t=r(e);return n(t,t=>{e(t)}),t}const i="__vue_reactive";function c(e){e.known.meta||(e.known.meta={});let t=e.known.meta[i];const n=e.known.values();t||(t=e[i]=s(Object.assign({},n,e.known.actions)));const a={};return Object.keys(n).forEach(e=>{a[e]=s=>{t[e]=s}}),Object.keys(n).forEach(t=>{e.core[t].up(a[t])}),t}function u(e){return function(e,t){return new Proxy(e,{get:(e,s)=>(d[s]||"string"!=typeof s||t[s],e[s]),set:(e,s,n,a)=>(e[s]=n,"string"==typeof s&&t[s]&&t[s](n),!0)})}(c(e),e.core)}const d={__v_raw:!0};function v(e,t,s){if(e.stateListeners||(e.stateListeners=new Map),e.stateListeners.has(t))e.stateListeners.get(t).add(s);else{const n=new Set;n.add(s),e.stateListeners.set(t,n)}}function f(e,t){e.stateListeners&&e.stateListeners.forEach(e=>{e.has(t)&&e.delete(t)})}function h(e,t){e.everythingListeners?.has(t)&&e.everythingListeners.delete(t)}function L(e,t){e.everythingListeners||(e.everythingListeners=new Set),e.everythingListeners.add(t)}const m={decay(e){const t=e=>{e&&e.forEach(e.delete)};t(e.buses),t(e.everythingListeners),e.stateListeners&&e.stateListeners.forEach((t,s)=>e.stateListeners.delete(s))},addEverythingListener:L,addEventListener:(e,t,s)=>v(e,t,s),removeEventListener:(e,t,s)=>{!function(e,t,s){if(e.stateListeners&&e.stateListeners.has(t)){const n=e.stateListeners.get(t);n.has(s)&&n.delete(s)}}(e,t,s)},removeListener:(e,t)=>{f(e,t),h(e,t)},dispatchEvent:(e,t,s)=>{e.everythingListeners&&e.everythingListeners.forEach(e=>e(t,s)),function(e,t,...s){e.stateListeners&&e.stateListeners.has(t)&&e.stateListeners.get(t).forEach(e=>e.apply(e,s))}(e,t,s)},getListenersMap:e=>(e.stateListeners||(e.stateListeners=new Map),e.stateListeners),addEventToBus(e,t,s){const n=e=>s.dispatchEvent(t,e);return v(e,t,n),n},removeEventToBus(e,t){f(e,t)},addBus(e,t){e.buses||(e.buses=new Set),e.buses.has(t)||(e.buses.add(t),L(e,t.dispatchEvent))},removeBus(e,t){e.buses?.has(t)&&(e.buses.delete(t),h(e,t.dispatchEvent))}},g={get(e,t){const s=m[t];return s?(...t)=>s(e,...t):(console.error(t,"404",e),e[t])}};const l="undefined"!=typeof window&&void 0!==window.document,y="AlakUnionNamespace",p={namespaces:{}};const w=()=>l?globalThis[y]?p.namespaces=globalThis[y]:globalThis[y]=p.namespaces:p.namespaces;const b={buses:"bus",cores:"core",actions:"action",states:"state"},E={get:(e,t)=>e.atoms[t][e.key]},k=e=>e[0].toLowerCase()+e.substring(1),M=["Core","State","Atom","Bus"],_={get(e,t){for(const s of M)if(t.endsWith(s)){const n=k(t).replace(s,""),a=e.atoms[n];if(a)return"Atom"===s?a:a[k(s)]}return b[t]?(e.activeFacades[t]||(e.activeFacades[t]=new Proxy({atoms:e.atoms,key:b[t]},E)),e.activeFacades[t]):e[t]}};function x(e){const t=e||"defaultUnion",s=w();if(s[t])return s[t];const n=new Proxy({id:t},g);const a={atoms:{},bus:n,ns:t,activeFacades:{}},r={uid:Math.random().toString(3),namespace:t,services:a,facade:new Proxy(a,_),bus:n,addAtom:e=>a.atoms[e.name]=undefined(e)};return s[t]=r,s[t]}function A(e){return function(){const t=x(e.namespace);let s=t.services.atoms[e.name];return s||(t.addAtom(Object.assign({},e)),s=t.services.atoms[e.name]),{state:e.sync?u(s):c(s),core:s.core}}}require("vue");export{c as default,A as vueController,r as vueNucleon,u as watchVueAtom,o as watchVueNucleon};
