!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).Vue={})}(this,function(e){"use strict";const t=require("vue"),{ref:s,reactive:n,watch:a}=t,o="vueKey";function r(e){if(e.hasMeta(o))return e.getMeta(o);{const t=s();return e.value&&(t.value=e.value),e.up(e=>t.value=e),t}}const i="__vue_reactive";function c(e){e.known.meta||(e.known.meta={});let t=e.known.meta[i];const s=e.known.values();t||(t=e[i]=n(Object.assign({},s,e.known.actions)));const a={};return Object.keys(s).forEach(e=>{a[e]=s=>{t[e]=s}}),Object.keys(s).forEach(t=>{e.core[t].up(a[t])}),t}function u(e){return function(e,t){return new Proxy(e,{get:(e,s)=>(d[s]||"string"!=typeof s||t[s],e[s]),set:(e,s,n,a)=>(e[s]=n,"string"==typeof s&&t[s]&&t[s](n),!0)})}(c(e),e.core)}const d={__v_raw:!0};function f(e,t,s){if(e.stateListeners||(e.stateListeners=new Map),e.stateListeners.has(t))e.stateListeners.get(t).add(s);else{const n=new Set;n.add(s),e.stateListeners.set(t,n)}}function v(e,t){e.stateListeners&&e.stateListeners.forEach(e=>{e.has(t)&&e.delete(t)})}function h(e,t){e.everythingListeners?.has(t)&&e.everythingListeners.delete(t)}function l(e,t){e.everythingListeners||(e.everythingListeners=new Set),e.everythingListeners.add(t)}const m={decay(e){const t=e=>{e&&e.forEach(e.delete)};t(e.buses),t(e.everythingListeners),e.stateListeners&&e.stateListeners.forEach((t,s)=>e.stateListeners.delete(s))},addEverythingListener:l,addEventListener:(e,t,s)=>f(e,t,s),removeEventListener:(e,t,s)=>{!function(e,t,s){if(e.stateListeners&&e.stateListeners.has(t)){const n=e.stateListeners.get(t);n.has(s)&&n.delete(s)}}(e,t,s)},removeListener:(e,t)=>{v(e,t),h(e,t)},dispatchEvent:(e,t,s)=>{e.everythingListeners&&e.everythingListeners.forEach(e=>e(t,s)),function(e,t,...s){e.stateListeners&&e.stateListeners.has(t)&&e.stateListeners.get(t).forEach(e=>e.apply(e,s))}(e,t,s)},getListenersMap:e=>(e.stateListeners||(e.stateListeners=new Map),e.stateListeners),addEventToBus(e,t,s){const n=e=>s.dispatchEvent(t,e);return f(e,t,n),n},removeEventToBus(e,t){v(e,t)},addBus(e,t){e.buses||(e.buses=new Set),e.buses.has(t)||(e.buses.add(t),l(e,t.dispatchEvent))},removeBus(e,t){e.buses?.has(t)&&(e.buses.delete(t),h(e,t.dispatchEvent))}},L={get(e,t){const s=m[t];return s?(...t)=>s(e,...t):(console.error(t,"404",e),e[t])}};const p="undefined"!=typeof window&&void 0!==window.document,g="AlakUnionNamespace",y={namespaces:{}};const b=()=>p?globalThis[g]?y.namespaces=globalThis[g]:globalThis[g]=y.namespaces:y.namespaces;const w={buses:"bus",cores:"core",actions:"action",states:"state"},E={get:(e,t)=>e.atoms[t][e.key]},k=e=>e[0].toLowerCase()+e.substring(1),_=["Core","State","Atom","Bus"],x={get(e,t){for(const s of _)if(t.endsWith(s)){const n=k(t).replace(s,""),a=e.atoms[n];if(a)return"Atom"===s?a:a[k(s)]}return w[t]?(e.activeFacades[t]||(e.activeFacades[t]=new Proxy({atoms:e.atoms,key:w[t]},E)),e.activeFacades[t]):e[t]}};function M(e){const t=e||"defaultUnion",s=b();if(s[t])return s[t];const n=new Proxy({id:t},L);const a={atoms:{},bus:n,ns:t,activeFacades:{}},o={uid:Math.random().toString(3),namespace:t,services:a,facade:new Proxy(a,x),bus:n,addAtom:e=>a.atoms[e.name]=undefined(e)};return s[t]=o,s[t]}require("vue"),e.default=c,e.vueController=function(e){return function(){const t=M(e.namespace);let s=t.services.atoms[e.name];return s||(t.addAtom(Object.assign({},e)),s=t.services.atoms[e.name]),{state:e.sync?u(s):c(s),core:s.core}}},e.vueNucleon=r,e.watchVueAtom=u,e.watchVueNucleon=function(e){const t=r(e);return a(t,t=>{e(t)}),t},Object.defineProperty(e,"__esModule",{value:!0})});
