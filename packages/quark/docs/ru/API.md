# Справочник API Quark

Этот документ детально описывает API для создания и управления Quarks (Кварками).

## Фабрики

### `Qu(options)`
Создает новый экземпляр Quark.

**Параметры (options):**
- `value` *(any)*: Начальное значение.
- `id` *(string)*: Уникальный идентификатор.
- `realm` *(string)*: Имя Realm (Мира), к которому принадлежит кварк.
- `dedup` *(boolean)*: Если false, отключает дедупликацию (по умолчанию: true).
- `stateless` *(boolean)*: Если true, не хранит значение, только излучает события.
- `emitChanges` *(boolean)*: Если true, автоматически отправляет события `CHANGE` в Quantum Bus.
- `emitChangeName` *(string)*: Кастомное имя события.
- `pipe` *(function)*: Функция-трансформер, применяемая перед установкой значения.

```typescript
import { Qu } from '@alaq/quark'

const q = Qu({ value: 10, id: 'counter' })
```

### `Qv(value, options)`
Сокращение для создания Quark с немедленной установкой значения.

```typescript
import { Qv } from '@alaq/quark'

const q = Qv(10, { id: 'counter' })
```

---

## Экземпляр Quark

Quark — это вызываемый объект (функция).
- **Get:** Доступ через `.value`.
- **Set:** Вызов `quark(newValue)` или присваивание `.value`.

### Методы

#### `.up(listener)`
Подписка на изменения значения.
- **listener**: `(value, quark) => void`
- *Возвращает:* `this`.

> **Важно:** Слушатель вызывается **сразу же** при подписке с текущим значением.

```typescript
q.up(val => console.log('Обновлено:', val))
```

#### `.down(listener)`
Отписка слушателя.

#### `.silent(value)`
Обновляет значение **без** уведомления слушателей и отправки событий в шину.

#### `.pipe(fn)`
Устанавливает функцию трансформации.

#### `.dedup(enable)`
Включает или выключает дедупликацию.

#### `.stateless(enable)`
Включает режим "без состояния".

#### `.decay()`
Уничтожает кварк (очищает слушателей и данные).